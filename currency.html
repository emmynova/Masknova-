<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Currency Converter — MaskNova Tech</title>
<style>
  body {
    margin:0; font-family:sans-serif; background:#0a0a0f; color:#fff;
    display:flex; flex-direction:column; align-items:center; padding:20px;
  }
  .back-btn {margin-bottom:15px; padding:8px 14px; background:#181824; color:#fff;
    text-decoration:none; border-radius:8px; border:1px solid #2a2f3a;}
  h1 {margin:10px 0 20px; color:#00e5ff;}
  .card {background:#12121a; padding:20px; border-radius:12px; max-width:420px; width:100%;}
  label {display:block; margin:10px 0 5px; font-size:14px;}
  input,select,button {
    width:100%; padding:10px; margin-bottom:14px;
    border-radius:8px; border:1px solid #2a2f3a; background:#181824; color:#fff;
  }
  button {background:#00e5ff; color:#000; font-weight:bold; cursor:pointer;}
  .result {margin-top:12px; padding:12px; border-radius:8px; background:#181824; text-align:center;}
  .status {font-size:12px; color:#9aa4b2; margin-top:8px; text-align:center;}
</style>
</head>
<body>

<a href="../dashboard.html" class="back-btn">⬅ Back to Dashboard</a>

<h1>💱 Currency Converter</h1>
<div class="card">
  <label for="amount">Amount</label>
  <input type="number" id="amount" placeholder="Enter amount" />

  <label for="from">From</label>
  <select id="from"></select>

  <label for="to">To</label>
  <select id="to"></select>

  <button id="convert">Convert</button>
  <div class="result" id="result">Converted amount will appear here</div>
  <div class="status" id="status">Loading rates…</div>
</div>

<script>
  const fromSel=document.getElementById("from");
  const toSel=document.getElementById("to");
  const resultBox=document.getElementById("result");
  const statusBox=document.getElementById("status");
  let rates={};

  // Populate dropdown with groups
  function populate(fiats, cryptos){
    fromSel.innerHTML=""; toSel.innerHTML="";
    const fGroup=document.createElement("optgroup"); fGroup.label="🌍 Fiat Currencies";
    fiats.forEach(c=>{let o=document.createElement("option");o.value=c;o.textContent=c;fGroup.appendChild(o);});
    const cGroup=document.createElement("optgroup"); cGroup.label="🪙 Cryptocurrencies";
    cryptos.forEach(c=>{let o=document.createElement("option");o.value=c;o.textContent=c;cGroup.appendChild(o);});
    fromSel.appendChild(fGroup); fromSel.appendChild(cGroup);
    toSel.appendChild(fGroup.cloneNode(true)); toSel.appendChild(cGroup.cloneNode(true));
    fromSel.value="USD"; toSel.value="NGN";
  }

  async function fetchRates(){
    try{
      // Fiat
      const resFiat=await fetch("https://api.exchangerate.host/latest?base=USD");
      const dataFiat=await resFiat.json();
      rates={USD:1,...dataFiat.rates};
      const fiatCodes=Object.keys(rates).sort();

      // Crypto
      const resCrypto=await fetch("https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&per_page=20&page=1");
      const dataCrypto=await resCrypto.json();
      const cryptoCodes=[];
      dataCrypto.forEach(c=>{
        const s=c.symbol.toUpperCase();
        if(!rates[s]){ rates[s]=1/c.current_price; cryptoCodes.push(s); }
      });

      populate(fiatCodes, cryptoCodes.sort());
      statusBox.textContent="✅ Live rates loaded";
    }catch(e){
      statusBox.textContent="⚠️ Could not load live rates";
      console.error(e);
    }
  }

  document.getElementById("convert").addEventListener("click",()=>{
    const amt=parseFloat(document.getElementById("amount").value);
    const from=fromSel.value, to=toSel.value;
    if(isNaN(amt)){ resultBox.textContent="Enter a valid amount"; return; }
    if(!rates[from]||!rates[to]){ resultBox.textContent="Unavailable currency"; return; }
    let usd=amt/rates[from];
    let converted=usd*rates[to];
    resultBox.textContent=`${amt} ${from} = ${converted.toFixed(4)} ${to}`;
  });

  fetchRates();
</script>

</body>
</html>
